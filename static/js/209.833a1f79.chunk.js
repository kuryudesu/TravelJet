"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[209],{209:(s,e,t)=>{t.r(e),t.d(e,{default:()=>d});var i=t(555),a=t(43),n=t(576),l=t(305),o=t(184),r=t(810),c=t(579);const d=()=>{const[s,e]=(0,a.useState)([]),[t,d]=(0,a.useState)(!0),[h,g]=(0,a.useState)(""),u=(0,n.Zp)();(0,a.useEffect)(()=>{(async()=>{try{const{data:s}=await(0,l.ZS)(),t=s.sort((s,e)=>s.status===e.status?new Date(e.flight_details.flight_date)-new Date(s.flight_details.flight_date):"confirmed"===s.status?-1:1);e(t)}catch(s){g("Failed to fetch your bookings. You might need to log in again."),!s.response||401!==s.response.status&&403!==s.response.status||setTimeout(()=>u("/login"),2e3)}finally{d(!1)}})()},[u]);return t?(0,c.jsx)(r.A,{}):h?(0,c.jsx)("div",{className:"bookings-error",children:h}):(0,c.jsxs)("div",{className:"bookings-page",children:[(0,c.jsx)("h1",{children:"My Bookings"}),s.length>0?(0,c.jsx)("div",{className:"bookings-list",children:s.map(s=>{return(0,c.jsxs)("div",{className:"booking-card ".concat(s.status),children:[(0,c.jsxs)("div",{className:"booking-header",children:[(0,c.jsx)("div",{className:"flight-info",children:(0,c.jsxs)("h3",{children:[s.flight_details.departure_iata,(0,c.jsx)(o.wmg,{}),s.flight_details.arrival_iata]})}),(0,c.jsx)("span",{className:"status-badge ".concat(s.status),children:s.status})]}),(0,c.jsxs)("div",{className:"booking-details",children:[(0,c.jsxs)("p",{children:[s.flight_details.departure," to ",s.flight_details.arrival]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Airline:"})," ",s.flight_details.airline]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Flight Number:"})," ",s.flight_details.flight_number]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Flight Date:"})," ",(t=s.flight_details.flight_date,t?new Date(t).toLocaleDateString("en-CA",{year:"numeric",month:"short",day:"numeric"}):"N/A")]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Flight Time:"})," ",s.flight_details.departure_time," - ",s.flight_details.arrival_time]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Booking Date:"})," ",new Date(s.booking_date).toLocaleString()]})]}),"confirmed"===s.status&&(0,c.jsx)("div",{className:"booking-actions",children:(0,c.jsx)("button",{className:"cancel-button",onClick:()=>(async s=>{if(window.confirm("Are you sure you want to cancel this booking?"))try{await(0,l.WD)(s),e(e=>e.map(e=>e.id===s?(0,i.A)((0,i.A)({},e),{},{status:"cancelled"}):e)),alert("Booking cancelled successfully.")}catch(n){var t,a;alert((null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to cancel the booking.")}})(s.id),children:"Cancel"})})]},s.id);var t})}):(0,c.jsxs)("div",{className:"no-bookings",children:[(0,c.jsx)("p",{children:"You have no bookings yet."}),(0,c.jsx)(n.N_,{to:"/",className:"book-now-button",children:"Book a Flight Now"})]})]})}}}]);
//# sourceMappingURL=209.833a1f79.chunk.js.map